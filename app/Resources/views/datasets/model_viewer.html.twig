{% extends 'default_bootstrap_admin.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{asset('lib/javascripts/voyager/css/normalize.css')}}">
    <link rel="stylesheet" href="{{asset('lib/javascripts/voyager/css/fontawesome.min.css')}}">
    <link rel="stylesheet" href="{{asset('lib/javascripts/voyager/css/fontawesome-solid.min.css')}}">
    <link rel="stylesheet" href="{{asset('lib/javascripts/voyager/css/voyager-explorer.css')}}">
    <style>
        .sv-carousel {
            position: absolute;
            bottom: 0;
            display: flex;
            flex-direction: row;
            display: none;
        }
        .sv-carousel img {
            display: block;
            width: 80px;
            height: 80px;
            margin: 6px 0 6px 6px;
            cursor: pointer;
        }
    </style>
{% endblock %}

{% block content %}
    <div id="main">
    </div>
    <div class="sv-carousel">
        {% for file in files %}
            <img data-item="{{file.metadata}}" src="{{file.file_path}}"/>
        {% endfor %}
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/16.4.2/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.4.2/umd/react-dom.production.min.js"></script>
    <script src="https://code.jquery.com/pep/0.4.3/pep.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/97/three.min.js"></script>

    <script src="{{asset('lib/javascripts/voyager/js/voyager-explorer.js')}}"></script>

    <script type="text/javascript">

      $(document).ready(function(){

        function load(element) {
          const itemUrl = element.getAttribute("data-item");
          if (itemUrl) {
            voyager.loadItem(itemUrl);
            console.log("loaded");
            return;
          }
          const presentationUrl = element.getAttribute("data-presentation");
          if (presentationUrl) {
            voyager.loadPresentation(presentationUrl);
          }
        }

        const voyager = new Voyager({ element: document.getElementById("main") });
        const carouselItems = document.getElementsByClassName("sv-carousel")[0].children;
        for (let i = 0; i < carouselItems.length; ++i) {
          carouselItems[i].onclick = (e) => load(e.target);
        }
        load(carouselItems[0]);

      });
    </script>
{% endblock %}