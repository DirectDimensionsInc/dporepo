{% use 'default_bootstrap_side_nav.html.twig' %}
{% extends 'base.html.twig' %}

{% set checked = '' %}
{% if is_favorite is defined and is_favorite %}
  {% set checked = ' checked="checked"' %}
{% endif %}

{% block body %}
  {#
    {% if navbar is not empty %}
      {% include navbar %}
    {% else %}
  #}
    <nav class="navbar navbar-inverse navbar-fixed-top">

      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">{{ site_title|e }}</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
          {% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/logout">Logout</a></li>
            </ul>
          {% endif %}
        </div> <!--/.navbar-collapse -->

      </div>

      {% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}
        <div class="container-fluid">
          <div class="row">
            <div class="col-sm-12">
              <ul class="nav nav-tabs">
                <li role="presentation" id="admin"><a href="/admin/">Dashboard</a></li>
                <li role="presentation" id="workspace"><a href="/admin/workspace/">Workspace</a></li>
                <li role="presentation" id="resources"><a href="/admin/resources/">Equipment/Resources</a></li>
                <li role="presentation" id="settings"><a href="/admin/settings/">Profile/Settings</a></li>
              </ul>
            </div>
          </div>
        </div> <!--/.container-fluid -->
      {% endif %}

    </nav>
    {# endif #}

    <div class="container-fluid">
      <div class="row resizable-columns">

        {% if is_granted('IS_AUTHENTICATED_REMEMBERED') and is_granted('ROLE_ADMIN') %}
          {% block side_nav %}
            {{ parent() }}
          {% endblock %}
          {% if (app.request.pathInfo == '/admin/workspace/') or (projects_id is defined) %}
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main resizable">
          {% else %}
            <div class="col-sm-12 main">
          {% endif %}
        {% else %}
          <div class="col-sm-7 col-md-6 col-lg-5 main resizable">
        {% endif %}

          {% if page_title is defined %}
            <label for="favorite_toggle" class="custom-checkbox">
              <h1 class="page-header">{{ page_title|e }}</h1>
              <input type="checkbox" id="favorite_toggle"{{ checked }} />
              <i class="glyphicon glyphicon-star-empty"></i>
              <i class="glyphicon glyphicon-star" title="Add/Remove from favorites"></i>
            </label>
          {% endif %}

          {% for label, messages in app.flashes %}
            {% for message in messages %}
              <div class="alert alert-success flash-{{ label }}" role="alert">
                {{ message }}
              </div>
            {% endfor %}
          {% endfor %}
          
          {% block content %}{% endblock %}

        </div> <!--/col-->
      </div> <!--/row-->

      <div class="row">
        <div class="clearfix"></div>
        {% if is_granted('IS_AUTHENTICATED_REMEMBERED') and is_granted('ROLE_ADMIN') %}
          <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 col-footer">
        {% else %}
          <div class="col-sm-12 col-md-12 col-footer">
        {% endif %}
          <footer class="footer">
            {# if site_footer is not empty #}
              {# include site_footer #}
            {# endif #}
          </footer>
        </div>
      </div>

    </div> <!--/.container-fluid-->
{% endblock %}

{% block stylesheets %}
    <!-- Bootstrap core CSS -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet" />
    <link href="{{ asset('lib/javascripts/vakata-jstree/dist/themes/proton/style.min.css') }}" rel="stylesheet" />
    <!-- <link href="{ asset('lib/javascripts/vakata-jstree/dist/themes/default/style.min.css') }" rel="stylesheet" /> -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/sweetalert/0.3.2/sweet-alert.min.css" rel="stylesheet" type="text/css" />
    <link href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet" />
    <link href="{{ asset('lib/css/styles.css') }}" rel="stylesheet" />

    <!-- Custom styles for this template -->
    <style type="text/css">

        label.custom-checkbox {
          /* Presentation */ 
          font-size: 24px;
          width: 100%;
          position: relative;
        }

        /* Required Styling */

        label.custom-checkbox input[type="checkbox"] {
          display: none;
        }

        .custom-checkbox .glyphicon-star,
        .custom-checkbox .glyphicon-star-empty {
          cursor: pointer;
        }

        .custom-checkbox .glyphicon {
          color: gold;
          position: absolute;
          top: 0.4em;
          left: -1.15em;
          font-size: 0.75em;
        }

        .custom-checkbox .glyphicon-star-empty {
          color: gray;
        }

        .custom-checkbox .glyphicon-star {
          opacity: 0;
          transition: opacity 0.2s ease-in-out;
        }

        .custom-checkbox .glyphicon-star:hover {
          opacity: 0.5;
        }

        .custom-checkbox input[type="checkbox"]:checked ~ .glyphicon-star {
          opacity: 1;
        }

        /*
         * Base structure
         */

        /* Move down content because we have a fixed navbar that is 50px tall */
        body {
          padding-top: 100px;
        }

        /*
         * Global add-ons
         */
        .sub-header {
          padding-bottom: 10px;
          border-bottom: 1px solid #eee;
        }

        /*
         * Top navigation
         * Hide default border to remove 1px line.
         */
        .navbar-fixed-top {
          border: 0;
        }

        /*
         * Sidebar
         */

        /* Hide for mobile, show later */
        /*.sidebar {
          display: none;
        }*/
        @media (min-width: 768px) {
          .sidebar {
            position: fixed;
            top: 78px;
            bottom: 0;
            left: 0;
            z-index: 900;
            display: block;
            padding: 20px;
            overflow-x: hidden;
            overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
            background-color: #f5f5f5;
            border-right: 1px solid #eee;
          }
        }

        /* Sidebar navigation */
        .nav-sidebar {
          margin-right: -21px; /* 20px padding + 1px border */
          margin-bottom: 20px;
          margin-left: -20px;
        }
        .nav-sidebar > li > a {
          padding-right: 20px;
          padding-left: 20px;
        }
        .nav-sidebar > .active > a,
        .nav-sidebar > .active > a:hover,
        .nav-sidebar > .active > a:focus {
          color: #fff;
          background-color: #428bca;
        }

        /*
         * Main content
         */
        .main {
          padding: 20px;
          min-height: 600px;
        }
        @media (min-width: 768px) {
          .main {
            padding-right: 40px;
            padding-left: 40px;
          }
        }
        .main .page-header {
          margin-top: 0;
        }

        .col-footer {
          padding: 0;
          border-top: 1px solid #e3e3e3;
          background-color: #ffffff;
        }

        /*
         * Top left navbar
         */
        .nav>li>a {
          position: relative;
          display: block;
          padding: 4px 15px 4px 18px;
        }

        /*
         * Top right navbar
         */
        .navbar-right {
          float: right !important;
          margin-right: 0px;
          margin-top: 10px;
        }

        /*
         * Sticky footer
         */
        .footer {
          background-color: #ffffff;
          display: block;
          padding: 10px 40px 30px 40px;
          margin: 10px 0 0 0;
        }

        /*
         * jQuery Datatables
         */
        #browse tbody tr {
          cursor: pointer;
        }

        /*
         * jQuery UI Resizable
         */
        .ui-resizable-handle {
          position: absolute;
          font-size: 0.1px;
          display: block;
          touch-action: none;
          width: 30px;
          right: -8px;
        }

        .ui-resizable-handle:after {
          content: "";
          display: block;
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          margin-top: -10px;
          width: 4px;
          height: 4px;
          border-radius: 50%;
          background: #a2a2a2;
          box-shadow: 0 10px 0 #a2a2a2, 0 20px 0 #a2a2a2;
        }
    </style>
{% endblock %}

{% block javascripts %}
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.3.1/jquery.cookie.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/0.3.2/sweet-alert.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="{{ asset('lib/javascripts/ie10-viewport-bug-workaround.js') }}"></script>
    <script src="{{ asset('lib/javascripts/javascript.js') }}"></script>
    <script src="{{ asset('lib/javascripts/vakata-jstree/dist/jstree.min.js') }}"></script>
    <script src="{{ asset('lib/javascripts/treeJavascript.js') }}"></script>
{% endblock %}